2024-09-08 06:26:03 (INFO): In the given configuration file or the configuration saved in the checkpoint, `normalize_labels` is set as `True` 
2024-09-08 06:26:03 (INFO):   MACE does not need OCP normalizers, instead it uses own normalization strategy.
2024-09-08 06:26:03 (INFO):   Hence `normalize_labels` will be changed as `False` to turn off the OCP normalizer operation.
2024-09-08 06:26:03 (INFO):   You can control their own normalization strategy by changing `scaling` and `shifting` in the model configuration.
2024-09-08 06:26:03 (INFO): Hidden irreps: 32x0e + 32x1o + 32x2e
2024-09-08 06:26:03 (INFO): z_table : AtomicNumberTable: (8, 72)
2024-09-08 06:26:03 (INFO): Loading train dataset (type: lmdb)
2024-09-08 06:26:03 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/train.lmdb
2024-09-08 06:26:03 (INFO): Loading validation dataset (type: lmdb)
2024-09-08 06:26:03 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/valid.lmdb
2024-09-08 06:26:03 (INFO): Loading test dataset (type: lmdb)
2024-09-08 06:26:03 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/test.lmdb
2024-09-08 06:26:03 (INFO): Load the computed results from datasets/HfO/atom_graph_rmax6.0_maxneighbor50/MACE_statistics.pt
2024-09-08 06:26:03 (INFO): Atomic energies: [-11.458882089641774, -5.729441044820888]
2024-09-08 06:26:03 (INFO): Average number of neighbors: 49.99997329711914
2024-09-08 06:26:03 (INFO): Loading model: mace
2024-09-08 06:26:04 (INFO): Loaded MACEWrap with 106800 parameters.
2024-09-08 06:26:04 (INFO): 
amp: false
cmd:
  checkpoint_dir: train_results/HfO/MACE/checkpoints/train-20240908_062602
  identifier: train
  logs_dir: train_results/HfO/MACE/logs/files/train-20240908_062602
  print_every: 100
  resume: false
  seed: 0
  show_eval_progressbar: false
  timestamp_id: train-20240908_062602
data_config_style: OCP
dataset:
  normalize_labels: false
  normalize_labels_json: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/normalize_stats.json
  per_atom: true
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/train.lmdb
gpus: 1
local_rank: 0
logger: files
model_attributes:
  E0s: average
  MLP_irreps: 16x0e
  atomic_energies:
  - !!python/object/apply:numpy.core.multiarray.scalar
    - &id001 !!python/object/apply:numpy.dtype
      args:
      - f8
      - false
      - true
      state: !!python/tuple
      - 3
      - <
      - null
      - null
      - null
      - -1
      - -1
      - 0
    - !!binary |
      j3bfl/LqJsA=
  - !!python/object/apply:numpy.core.multiarray.scalar
    - *id001
    - !!binary |
      kHbfl/LqFsA=
  atomic_inter_scale: 1.9410662651062012
  atomic_inter_shift: -5.043370095483279e-06
  avg_num_neighbors: 49.99997329711914
  chemical_symbols:
  - O
  - Hf
  correlation: 3
  cutoff: 6.0
  gate: silu
  hidden_irreps: 32x0e + 32x1o + 32x2e
  max_ell: 3
  max_neighbors: 50
  num_cutoff_basis: 5
  num_interactions: 2
  num_radial_basis: 8
  otf_graph: false
  regress_forces: true
  scaling: rms_forces_scaling
  shifting: true
  use_pbc: true
model_name: mace
noddp: false
optim:
  batch_size: 16
  ema_decay: 0.99
  energy_coefficient: 1
  eval_batch_size: 16
  force_coefficient: 1
  loss_energy: energy_per_atom_mse
  loss_force: force_per_dim_mse
  lr_initial: 0.01
  max_epochs: 10
  num_test: 150
  num_train: 1200
  num_val: 150
  num_workers: 2
  optimizer: Adam
  optimizer_params:
    amsgrad: false
  scheduler: LinearLR
  weight_decay: 5.0e-07
save_ckpt_every_epoch: 20
slurm: {}
task:
  dataset: lmdb
  description: Regressing to energies and forces for DFT trajectories of HfO
  eval_on_free_atoms: false
  metrics:
  - energy_per_atom_mae
  - energy_per_atom_mse
  - forces_mae
  - forces_mse
  primary_metric: forces_mse
  train_on_free_atoms: false
test_dataset:
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/test.lmdb
val_dataset:
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/valid.lmdb

2024-09-08 06:26:31 (INFO): [train] epoch 1.0 (step 75): energy_per_atom_mae 0.24070 energy_per_atom_rmse 0.36664 forces_mae 0.83531 forces_rmse 1.24734 loss 1.69029 lr 9.01e-03
2024-09-08 06:26:34 (INFO): [val] epoch 1.0: energy_per_atom_mae 0.98420 energy_per_atom_rmse 1.02268 forces_mae 1.22712 forces_rmse 1.78479 loss 4.19697
2024-09-08 06:26:34 (INFO): 1 epoch elapsed time: 29.8 sec
2024-09-08 06:26:40 (INFO): [train] epoch 1.3 (step 100): energy_per_atom_mae 0.03567 energy_per_atom_rmse 0.04415 forces_mae 0.45291 forces_rmse 0.62580 loss 0.39357 lr 8.68e-03
2024-09-08 06:26:52 (INFO): [train] epoch 2.0 (step 150): energy_per_atom_mae 0.03300 energy_per_atom_rmse 0.04167 forces_mae 0.33285 forces_rmse 0.46370 loss 0.21675 lr 8.01e-03
2024-09-08 06:26:54 (INFO): [val] epoch 2.0: energy_per_atom_mae 0.81239 energy_per_atom_rmse 0.84278 forces_mae 0.89879 forces_rmse 1.31585 loss 2.41961
2024-09-08 06:26:54 (INFO): 2 epoch elapsed time: 19.8 sec
2024-09-08 06:27:06 (INFO): [train] epoch 2.7 (step 200): energy_per_atom_mae 0.03058 energy_per_atom_rmse 0.03980 forces_mae 0.25479 forces_rmse 0.35970 loss 0.13097 lr 7.35e-03
2024-09-08 06:27:12 (INFO): [train] epoch 3.0 (step 225): energy_per_atom_mae 0.02817 energy_per_atom_rmse 0.03560 forces_mae 0.21873 forces_rmse 0.30489 loss 0.09423 lr 7.01e-03
2024-09-08 06:27:12 (INFO): [val] epoch 3.0: energy_per_atom_mae 0.60384 energy_per_atom_rmse 0.62264 forces_mae 0.58917 forces_rmse 0.84871 loss 1.10046
2024-09-08 06:27:13 (INFO): 3 epoch elapsed time: 18.9 sec
2024-09-08 06:27:30 (INFO): [train] epoch 4.0 (step 300): energy_per_atom_mae 0.02901 energy_per_atom_rmse 0.03740 forces_mae 0.18760 forces_rmse 0.26981 loss 0.07420 lr 6.01e-03
2024-09-08 06:27:31 (INFO): [val] epoch 4.0: energy_per_atom_mae 0.37416 energy_per_atom_rmse 0.38427 forces_mae 0.37644 forces_rmse 0.53742 loss 0.43471
2024-09-08 06:27:31 (INFO): 4 epoch elapsed time: 18.7 sec
2024-09-08 06:27:49 (INFO): [train] epoch 5.0 (step 375): energy_per_atom_mae 0.02657 energy_per_atom_rmse 0.03394 forces_mae 0.16275 forces_rmse 0.23681 loss 0.05723 lr 5.01e-03
2024-09-08 06:27:50 (INFO): [val] epoch 5.0: energy_per_atom_mae 0.19752 energy_per_atom_rmse 0.20424 forces_mae 0.25433 forces_rmse 0.36544 loss 0.17453
2024-09-08 06:27:50 (INFO): 5 epoch elapsed time: 18.7 sec
2024-09-08 06:27:56 (INFO): [train] epoch 5.3 (step 400): energy_per_atom_mae 0.01623 energy_per_atom_rmse 0.02098 forces_mae 0.14249 forces_rmse 0.19969 loss 0.04032 lr 4.68e-03
2024-09-08 06:28:08 (INFO): [train] epoch 6.0 (step 450): energy_per_atom_mae 0.01897 energy_per_atom_rmse 0.02495 forces_mae 0.14844 forces_rmse 0.21980 loss 0.04893 lr 4.01e-03
2024-09-08 06:28:09 (INFO): [val] epoch 6.0: energy_per_atom_mae 0.10210 energy_per_atom_rmse 0.10489 forces_mae 0.18823 forces_rmse 0.27299 loss 0.08505
2024-09-08 06:28:09 (INFO): 6 epoch elapsed time: 18.8 sec
2024-09-08 06:28:21 (INFO): [train] epoch 6.7 (step 500): energy_per_atom_mae 0.01435 energy_per_atom_rmse 0.01969 forces_mae 0.14132 forces_rmse 0.20679 loss 0.04315 lr 3.35e-03
2024-09-08 06:28:26 (INFO): [train] epoch 7.0 (step 525): energy_per_atom_mae 0.01391 energy_per_atom_rmse 0.01822 forces_mae 0.13655 forces_rmse 0.19061 loss 0.03666 lr 3.01e-03
2024-09-08 06:28:27 (INFO): [val] epoch 7.0: energy_per_atom_mae 0.05345 energy_per_atom_rmse 0.05506 forces_mae 0.15691 forces_rmse 0.22930 loss 0.05517
2024-09-08 06:28:27 (INFO): 7 epoch elapsed time: 18.7 sec
2024-09-08 06:28:45 (INFO): [train] epoch 8.0 (step 600): energy_per_atom_mae 0.01267 energy_per_atom_rmse 0.01776 forces_mae 0.13253 forces_rmse 0.19160 loss 0.03703 lr 2.01e-03
2024-09-08 06:28:46 (INFO): [val] epoch 8.0: energy_per_atom_mae 0.02730 energy_per_atom_rmse 0.02993 forces_mae 0.14227 forces_rmse 0.20839 loss 0.04389
2024-09-08 06:28:46 (INFO): 8 epoch elapsed time: 19.0 sec
2024-09-08 06:29:04 (INFO): [train] epoch 9.0 (step 675): energy_per_atom_mae 0.01189 energy_per_atom_rmse 0.01591 forces_mae 0.12736 forces_rmse 0.18415 loss 0.03416 lr 1.01e-03
2024-09-08 06:29:05 (INFO): [val] epoch 9.0: energy_per_atom_mae 0.01570 energy_per_atom_rmse 0.01924 forces_mae 0.13532 forces_rmse 0.19865 loss 0.03940
2024-09-08 06:29:05 (INFO): 9 epoch elapsed time: 18.8 sec
2024-09-08 06:29:11 (INFO): [train] epoch 9.3 (step 700): energy_per_atom_mae 0.00926 energy_per_atom_rmse 0.01173 forces_mae 0.12336 forces_rmse 0.17324 loss 0.03015 lr 6.80e-04
2024-09-08 06:29:23 (INFO): [train] epoch 10.0 (step 750): energy_per_atom_mae 0.00911 energy_per_atom_rmse 0.01292 forces_mae 0.12582 forces_rmse 0.18420 loss 0.03410 lr 1.33e-05
2024-09-08 06:29:24 (INFO): [val] epoch 10.0: energy_per_atom_mae 0.01085 energy_per_atom_rmse 0.01448 forces_mae 0.13180 forces_rmse 0.19371 loss 0.03730
2024-09-08 06:29:24 (INFO): 10 epoch elapsed time: 18.8 sec
2024-09-08 06:29:24 (INFO): train() elapsed time: 199.9 sec
2024-09-08 06:29:24 (INFO): Performing the final evaluation (last model)
2024-09-08 06:29:24 (INFO): Evaluating on train ...
2024-09-08 06:29:29 (INFO): Evaluating on val ...
2024-09-08 06:29:30 (INFO): Evaluating on test ...
2024-09-08 06:29:31 (INFO): 
+---------+---------------------+----------------------+------------+-------------+
| dataset | energy_per_atom_mae | energy_per_atom_rmse | forces_mae | forces_rmse |
+---------+---------------------+----------------------+------------+-------------+
|  train  |         11.0        |         14.9         |   127.3    |    184.0    |
|   val   |         10.8        |         14.5         |   131.8    |    193.7    |
|   test  |         14.9        |         65.6         |   133.1    |    295.5    |
+---------+---------------------+----------------------+------------+-------------+
2024-09-08 06:29:31 (INFO): Total time taken: 209.4 sec (0.1 h)
