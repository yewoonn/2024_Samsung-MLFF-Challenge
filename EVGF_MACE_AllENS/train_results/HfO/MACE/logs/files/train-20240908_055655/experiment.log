2024-09-08 05:56:56 (INFO): In the given configuration file or the configuration saved in the checkpoint, `normalize_labels` is set as `True` 
2024-09-08 05:56:56 (INFO):   MACE does not need OCP normalizers, instead it uses own normalization strategy.
2024-09-08 05:56:56 (INFO):   Hence `normalize_labels` will be changed as `False` to turn off the OCP normalizer operation.
2024-09-08 05:56:56 (INFO):   You can control their own normalization strategy by changing `scaling` and `shifting` in the model configuration.
2024-09-08 05:56:56 (INFO): Hidden irreps: 32x0e + 32x1o + 32x2e
2024-09-08 05:56:56 (INFO): z_table : AtomicNumberTable: (8, 72)
2024-09-08 05:56:56 (INFO): Loading train dataset (type: lmdb)
2024-09-08 05:56:56 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/train.lmdb
2024-09-08 05:56:56 (INFO): Loading validation dataset (type: lmdb)
2024-09-08 05:56:56 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/valid.lmdb
2024-09-08 05:56:56 (INFO): Loading test dataset (type: lmdb)
2024-09-08 05:56:56 (INFO):  - datasets/HfO/atom_graph_rmax6.0_maxneighbor50/test.lmdb
2024-09-08 05:56:56 (INFO): Load the computed results from datasets/HfO/atom_graph_rmax6.0_maxneighbor50/MACE_statistics.pt
2024-09-08 05:56:56 (INFO): Atomic energies: [-11.458882089641774, -5.729441044820888]
2024-09-08 05:56:56 (INFO): Average number of neighbors: 49.99997329711914
2024-09-08 05:56:56 (INFO): Loading model: mace
2024-09-08 05:56:57 (INFO): Loaded MACEWrap with 442992 parameters.
2024-09-08 05:56:57 (INFO): 
amp: false
cmd:
  checkpoint_dir: train_results/HfO/MACE/checkpoints/train-20240908_055655
  identifier: train
  logs_dir: train_results/HfO/MACE/logs/files/train-20240908_055655
  print_every: 100
  resume: false
  seed: 0
  show_eval_progressbar: false
  timestamp_id: train-20240908_055655
data_config_style: OCP
dataset:
  normalize_labels: false
  normalize_labels_json: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/normalize_stats.json
  per_atom: true
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/train.lmdb
gpus: 1
local_rank: 0
logger: files
model_attributes:
  E0s: average
  MLP_irreps: 16x0e
  atomic_energies:
  - !!python/object/apply:numpy.core.multiarray.scalar
    - &id001 !!python/object/apply:numpy.dtype
      args:
      - f8
      - false
      - true
      state: !!python/tuple
      - 3
      - <
      - null
      - null
      - null
      - -1
      - -1
      - 0
    - !!binary |
      j3bfl/LqJsA=
  - !!python/object/apply:numpy.core.multiarray.scalar
    - *id001
    - !!binary |
      kHbfl/LqFsA=
  atomic_inter_scale: 1.9410662651062012
  atomic_inter_shift: -5.043370095483279e-06
  avg_num_neighbors: 49.99997329711914
  chemical_symbols:
  - O
  - Hf
  correlation: 3
  cutoff: 6.0
  gate: silu
  hidden_irreps: 32x0e + 32x1o + 32x2e
  max_ell: 3
  max_neighbors: 50
  num_cutoff_basis: 5
  num_interactions: 2
  num_radial_basis: 8
  otf_graph: false
  regress_forces: true
  scaling: rms_forces_scaling
  shifting: true
  use_pbc: true
model_name: mace
noddp: false
optim:
  batch_size: 16
  ema_decay: 0.99
  energy_coefficient: 1
  eval_batch_size: 16
  force_coefficient: 1
  loss_energy: energy_per_atom_mse
  loss_force: force_per_dim_mse
  lr_initial: 0.01
  max_epochs: 3
  num_test: 150
  num_train: 1200
  num_val: 150
  num_workers: 2
  optimizer: Adam
  optimizer_params:
    amsgrad: false
  scheduler: LinearLR
  weight_decay: 5.0e-07
save_ckpt_every_epoch: 20
slurm: {}
task:
  dataset: lmdb
  description: Regressing to energies and forces for DFT trajectories of HfO
  eval_on_free_atoms: false
  metrics:
  - energy_per_atom_mae
  - energy_per_atom_mse
  - forces_mae
  - forces_mse
  primary_metric: forces_mse
  train_on_free_atoms: false
test_dataset:
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/test.lmdb
val_dataset:
  src: datasets/HfO/atom_graph_rmax6.0_maxneighbor50/valid.lmdb

2024-09-08 05:59:48 (INFO): [train] epoch 1.0 (step 75): energy_per_atom_mae 0.14342 energy_per_atom_rmse 0.22900 forces_mae 0.61164 forces_rmse 0.93247 loss 0.92193 lr 6.71e-03
2024-09-08 06:00:09 (INFO): [val] epoch 1.0: energy_per_atom_mae 0.22314 energy_per_atom_rmse 0.34944 forces_mae 0.98994 forces_rmse 1.46303 loss 2.23497
2024-09-08 06:00:10 (INFO): 1 epoch elapsed time: 192.4 sec
2024-09-08 06:01:04 (INFO): [train] epoch 1.3 (step 100): energy_per_atom_mae 0.04092 energy_per_atom_rmse 0.05192 forces_mae 0.29387 forces_rmse 0.40685 loss 0.16822 lr 5.60e-03
2024-09-08 06:02:51 (INFO): [train] epoch 2.0 (step 150): energy_per_atom_mae 0.03061 energy_per_atom_rmse 0.04079 forces_mae 0.25361 forces_rmse 0.35636 loss 0.12865 lr 3.38e-03
2024-09-08 06:03:11 (INFO): [val] epoch 2.0: energy_per_atom_mae 0.10226 energy_per_atom_rmse 0.18789 forces_mae 0.64977 forces_rmse 0.95504 loss 0.93549
2024-09-08 06:03:11 (INFO): 2 epoch elapsed time: 181.6 sec
2024-09-08 06:04:59 (INFO): [train] epoch 2.7 (step 200): energy_per_atom_mae 0.02402 energy_per_atom_rmse 0.03124 forces_mae 0.21632 forces_rmse 0.30475 loss 0.09385 lr 1.16e-03
2024-09-08 06:05:53 (INFO): [train] epoch 3.0 (step 225): energy_per_atom_mae 0.02248 energy_per_atom_rmse 0.02922 forces_mae 0.20843 forces_rmse 0.28843 loss 0.08405 lr 4.44e-05
2024-09-08 06:06:12 (INFO): [val] epoch 3.0: energy_per_atom_mae 0.05963 energy_per_atom_rmse 0.11142 forces_mae 0.41121 forces_rmse 0.60101 loss 0.36957
2024-09-08 06:06:12 (INFO): 3 epoch elapsed time: 180.8 sec
2024-09-08 06:06:12 (INFO): train() elapsed time: 554.8 sec
2024-09-08 06:06:12 (INFO): Performing the final evaluation (last model)
2024-09-08 06:06:12 (INFO): Evaluating on train ...
2024-09-08 06:08:42 (INFO): Evaluating on val ...
2024-09-08 06:09:01 (INFO): Evaluating on test ...
2024-09-08 06:09:20 (INFO): 
+---------+---------------------+----------------------+------------+-------------+
| dataset | energy_per_atom_mae | energy_per_atom_rmse | forces_mae | forces_rmse |
+---------+---------------------+----------------------+------------+-------------+
|  train  |         52.3        |         95.4         |   400.5    |    577.1    |
|   val   |         59.6        |        111.4         |   411.2    |    601.0    |
|   test  |         48.1        |         86.8         |   396.6    |    583.4    |
+---------+---------------------+----------------------+------------+-------------+
2024-09-08 06:09:20 (INFO): Total time taken: 745.6 sec (0.2 h)
